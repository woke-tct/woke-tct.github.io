/* var audio1 = new Audio('https://audio.jukehost.co.uk/AYUPLM4TmsXr7dTw7Ycwj3DRmjw6EdJA');
audio1.volume = 1;
audio1.loop = true;
audio1.play(); */
RecReading=true;
e = campaignTrail_temp;

e.mod_achievements = true;

campaignTrail_temp.achievements = {
	"Faded Light" : {
		"image" : "https://i.imgur.com/97LKctI.png",
		"description" : "This world cannot pierce the veil between. Load the world to resume.",
		"cannotBeCheated" : false,
	},
}

ach_list = {
	"Everywhere at the End of Time" : {
		"image" : "https://i.imgur.com/2K4r2lL.png",
		"description" : "Finish the game.",
		"cannotBeCheated" : false,
		"chained_achievements" : false,
	},
	"Hello World!" : {
		"image" : "https://i.imgur.com/QGAPHrP.png",
		"description" : "Be introduced to Sarah Webster.",
		"cannotBeCheated" : false,
		"chained_achievements" : false,
	},
	"Pillow God" : {
		"image" : "https://i.imgur.com/Rbbw6JQ.png",
		"description" : "(Shadow Achievement) Appease the pillow god.",
		"cannotBeCheated" : false,
		"chained_achievements" : false,
	},
	"Loudmouth Businessman" : {
		"image" : "https://i.imgur.com/3I3CM9n.png",
		"description" : "Face off against Luca Perez.",
		"cannotBeCheated" : false,
		"chained_achievements" : ["Loudmouth Businessman", "Stodgy Old Evangelical", "Soul Singer", "Quiet Bureaucrat", "Hopeful Humanitarian", "Enigmatic Traveller"],
	},
	"Stodgy Old Evangelical" : {
		"image" : "https://i.imgur.com/pZ30TgD.png",
		"description" : "Face off against Robert T. Edwards.",
		"cannotBeCheated" : false,
		"chained_achievements" : ["Loudmouth Businessman", "Stodgy Old Evangelical", "Soul Singer", "Quiet Bureaucrat", "Hopeful Humanitarian", "Enigmatic Traveller"],
	},
	"Soul Singer" : {
		"image" : "https://i.imgur.com/YDBGebA.png",
		"description" : "Face off against John King.",
		"cannotBeCheated" : false,
		"chained_achievements" : ["Loudmouth Businessman", "Stodgy Old Evangelical", "Soul Singer", "Quiet Bureaucrat", "Hopeful Humanitarian", "Enigmatic Traveller"],
	},
	"Quiet Bureaucrat" : {
		"image" : "https://i.imgur.com/aSiL684.png",
		"description" : "Face off against Tim Jacobs.",
		"cannotBeCheated" : false,
		"chained_achievements" : ["Loudmouth Businessman", "Stodgy Old Evangelical", "Soul Singer", "Quiet Bureaucrat", "Hopeful Humanitarian", "Enigmatic Traveller"],
	},
	"Hopeful Humanitarian" : {
		"image" : "https://i.imgur.com/3zSV8nl.png",
		"description" : "Face off against Emilia Kelly.",
		"cannotBeCheated" : false,
		"chained_achievements" : ["Loudmouth Businessman", "Stodgy Old Evangelical", "Soul Singer", "Quiet Bureaucrat", "Hopeful Humanitarian", "Enigmatic Traveller"],
	},
	"Enigmatic Traveller" : {
		"image" : "https://i.imgur.com/QrJeBZg.png",
		"description" : "Face off against Elizabeth Haley.",
		"cannotBeCheated" : false,
		"chained_achievements" : ["Loudmouth Businessman", "Stodgy Old Evangelical", "Soul Singer", "Quiet Bureaucrat", "Hopeful Humanitarian", "Enigmatic Traveller"],
	},
	"Seam 1" : {
		"image" : "https://i.imgur.com/aDo04Tu.png",
		"description" : "Find a seam in reality.",
		"cannotBeCheated" : false,
		"chained_achievements" : false,
	},
	"Seam 2" : {
		"image" : "https://i.imgur.com/9wMz7d5.png",
		"description" : "Find a seam in reality.",
		"cannotBeCheated" : false,
		"chained_achievements" : false,
	},
	"Seam 3" : {
		"image" : "https://i.imgur.com/inlkPKL.png",
		"description" : "Find a seam in reality.",
		"cannotBeCheated" : false,
		"chained_achievements" : false,
	},
	"Seam 4" : {
		"image" : "https://i.imgur.com/pzPhMFi.png",
		"description" : "Find a seam in reality.",
		"cannotBeCheated" : false,
		"chained_achievements" : false,
	},
	"Seam 5" : {
		"image" : "https://i.imgur.com/Wznk9yt.png",
		"description" : "Find a seam in reality.",
		"cannotBeCheated" : false,
		"chained_achievements" : false,
	},
	"Seam 6" : {
		"image" : "https://i.imgur.com/r1cNHZT.png",
		"description" : "Find a seam in reality.",
		"cannotBeCheated" : false,
		"chained_achievements" : false,
	},
}

function append_achievement(name, recursive) {
	allAch["21028"][name]=ach_list[name];
	addAllAchievements();
	if (recursive == false) {
		for (let n = 0; n<ach_list[name]["chained_achievements"].length; n++) {
			append_achievement(ach_list[name]["chained_achievements"][n], true);
		}
	}
}

function silent_unlock(name) {
  const ach = findAchievementByName(name);

  if (ach == null) {
    console.log("There is no achievement with the name '" + name + "'");
    return;
  }

  if (cheatsActive && ach.cannotBeCheated) {
    console.log(`Would unlock '${name}' but won't because cheating!`);
    return;
  }

  unlockedAch[name] = ach;
  localStorage.setItem("unlockedAch", JSON.stringify(unlockedAch));
  addAllAchievements();
}

for (let ach_name in allAch["21028"]) {
	console.log(ach_name);
	if (ach_list[ach_name] == null) {
		delete allAch["21028"][ach_name];
	}
}

// Set up all the achievements.
campaignTrail_temp.achievements = {}
append_achievement("Everywhere at the End of Time");
for (let ach_name in ach_list) {
	if (JSON.parse(localStorage["unlockedAch"])[ach_name] != null) {
		append_achievement(ach_name);
		silent_unlock(ach_name);
		if (ach_list[ach_name]["chained_achievements"] != false) {
			for (let n = 0; n<ach_list[ach_name]["chained_achievements"].length; n++) {
				append_achievement(ach_list[ach_name]["chained_achievements"][n]);
			}
		}
	}
}

campaignTrail_temp.modBoxTheme = {
  "header_color": "#444444",
  "header_text_color": "#ffffff",
  "description_text_color": "#000000",
  "description_background_color": "#ffffff",
  "main_color": "#000000",
  "secondary_color": "#333333",
  "ui_text_color": "#ffffff"
}

e.collect_results = true;
e.election_json = [
	{
		"model":"campaign_trail.election",
		"pk": 21,
		"fields": {
			"year": 21028,
			"summary": "<span id='21028description' style='display: initial;'><div style='overflow-y:scroll;height:200px;'>(Epilepsy Warning, this mod will contain flashing images.)<br><br>&lt;System Check Tick, all systems clear,&gt;<br><br>The year is 21,028.<br><br>…<br><br>&lt;System Check Tick, all systems clear,&gt;<br><br>It has been over 19,000 years since the dawn of the New World. <br><br>…<br><br></div><br><button onclick='show()'>About 17776/20021</button></span><span id='17776description' style='display: none;overflow-y:scroll;height:213px;'><div style='overflow-y:scroll;height:200px;'>On April 7th, 2026, humanity stopped aging, and no new babies could be conceived. Soon after that, the nano system went online, protecting humans from all forms of harm, and ensuring no human would ever die again. Since then, human cultural progress has mostly stagnated, with all the old generations having culturally stagnated around the world of the 2020’s.<br><br>Humans have given up the pursuit of conquest and ambition, instead contenting themselves with the act of endless leisure and recreation. The original story of 17776 and its sequel, 20020, are written by Jon Bois, and this mod is a fan-work set in this timeline in the year 21028.<br><br></div><br><button onclick='back()'>Back</button></span>",
			"image_url": "https://i.imgur.com/5YD6nnp.png",
			"winning_electoral_vote_number":270,
			"advisor_url":"",
			"recommended_reading":`<a href="https://www.sbnation.com/a/17776-football">17776 Original</a>, <a href="https://www.sbnation.com/c/secret-base/21410129/20020">20020 Original</a>, <a href="https://www.biblegateway.com/passage/?search=Ezekiel+1%3A1-28&version=ESV">The Holy Bible</a>`,
			"has_visits":0,
			"no_electoral_majority_image":"../static/images/2012-no-majority.jpg"}}];

show = function() {
	document.getElementById("21028description").style.display = 'none';
	document.getElementById("17776description").style.display = 'initial';
}

back = function() {
	document.getElementById("17776description").style.display = 'none';
	document.getElementById("21028description").style.display = 'initial';
}
		
e.candidate_json = [
	{
		"model":"campaign_trail.candidate",
		"pk":300,
        "fields": {
            "first_name": "",
            "last_name": "(The New World)",
            "election": 21,
            "party": "New Worlder",
            "state": "Earth",
            "priority": 1,
            "description": "No one knows how it happened, one day the world just… Stopped. People stopped aging, and no new people could be born. Like a universal lever went off, and somewhere, humanity was caught between the gears of some great cosmic machine.\n<br><br>\nThe fire that inspired them to tame their world has long since burnt out, crushed like Atlas under the unbearable weight of endless monotony. Everyone stood still, and everyone has stood still for over 19,000 years now.\n",
            "color_hex": "#ffef00",
            "secondary_color_hex": null,
            "is_active": 1,
            "image_url": "https://i.imgur.com/t1gGaI0.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": null,
            "candidate_score": 1,
            "running_mate": false
        }	
	},
	
	{
		"model":"campaign_trail.candidate",
		"pk":301,
        "fields": {
            "first_name": "",
            "last_name": "New Worlders",
            "election": 21,
            "party": "Other",
            "state": "Other",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#7f7f7f",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://www.jetsimon.com/public/candidateexample.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": null,
            "candidate_score": 1,
            "running_mate": false
        }
	},
    {
        "model": "campaign_trail.candidate",
        "pk": 302,
        "fields": {
            "first_name": "",
            "last_name": "Independents",
            "election": 21,
            "party": "Other",
            "state": "Other",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#7f7f7f",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://www.jetsimon.com/public/candidateexample.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": null,
            "candidate_score": 1,
            "running_mate": false
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 303,
        "fields": {
            "first_name": "",
            "last_name": "Old Worlders",
            "election": 21,
            "party": "Other",
            "state": "Other",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#7f7f7f",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://www.jetsimon.com/public/candidateexample.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": null,
            "candidate_score": 1,
            "running_mate": false
        }
    },
	{
        "model": "campaign_trail.candidate",
        "pk": 304,
        "fields": {
            "first_name": "Pioneer",
            "last_name": "Nine",
            "election": 21,
            "party": "Old Worlder",
            "state": "Deep Space",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#a80000",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://i.imgur.com/Sl8HUsT.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "(Power is currently off, recharging.)<br><br>\n…<br><br>\n&lt;System Check Tick, all systems clear.&gt;<br><br>\n…<br><br>\n&lt;System Check Tick, all systems clear.&gt;<br><br>\n…\n",
            "candidate_score": 1,
            "running_mate": true
        }
    },
	{
        "model": "campaign_trail.candidate",
        "pk": 305,
        "fields": {
            "first_name": "Gray",
            "last_name": "Patterson",
            "election": 21,
            "party": "Independent",
            "state": "Pennsylvania",
            "priority": 1,
            "description": "Elections rarely mean much anymore in today’s day and age. When there are thousands of ex-presidents to keep track of, it gets hard to care much about the topic. Becoming the president is now more of a formality, something individuals do for the heck of it. Gray Patterson was one of these individuals. He had run this campaign as a way to have fun with his friends.<br><br>With the discovery of extraterrestrial life throwing the election into disarray, everything changes; the first status quo shift in over 15,000 years. Suddenly, all that seemed certain about life was no longer. Should we reach out? Should we stay quiet? Should we fight? This isn’t an election for show anymore, the American people are counting on you.",
            "color_hex": "#CBCBCB",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://i.imgur.com/2Lmm31K.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "Elections rarely mean much anymore in today’s day and age. When there are thousands of ex-presidents to keep track of, it gets hard to care much about the topic. Becoming the president is now more of a formality, something individuals do for the heck of it. Gray Patterson was one of these individuals. He had run this campaign as a way to have fun with his friends.<br><br>With the discovery of extraterrestrial life throwing the election into disarray, everything changes; the first status quo shift in over 15,000 years. Suddenly, all that seemed certain about life was no longer. Should we reach out? Should we stay quiet? Should we fight? This isn’t an election for show anymore, the American people are counting on you.",
            "candidate_score": 1,
            "running_mate": true
        }
    },
	    {
        "model": "campaign_trail.candidate",
        "pk": 306,
        "fields": {
            "first_name": "Mark",
            "last_name": "Eastwood",
            "election": 21,
            "party": "Independent",
            "state": "Pennsylvania",
            "priority": 1,
            "description": "You and Mark were only in high school when the New World came about, and neither of you have really left that phase since. You saw as the world froze still, the last children born, and the wheel of progress slowed to its final resting place. He’s your best friend, always has been, went to school together, grew up together through thick and thin.<br><br>He doesn’t particularly care about politics, and you more than suspect he’s a little hesitant. But you wouldn’t have anyone else as your running mate, and he wants to be there when you need him. You think it would be a fun time in the White House, he’s just along for the ride.",
            "color_hex": "#ffd500",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://i.imgur.com/1ifo1FL.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "You and Mark were only in high school when the New World came about, and neither of you have really left that phase since. You saw as the world froze still, the last children born, and the wheel of progress slowed to its final resting place. He’s your best friend, always has been, went to school together, grew up together through thick and thin.<br><br>He doesn’t particularly care about politics, and you more than suspect he’s a little hesitant. But you wouldn’t have anyone else as your running mate, and he wants to be there when you need him. You think it would be a fun time in the White House, he’s just along for the ride.",
            "candidate_score": 1,
            "running_mate": true
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 307,
        "fields": {
            "first_name": "Sarah",
            "last_name": "Webster",
            "election": 21,
            "party": "Independent",
            "state": "Pennsylvania",
            "priority": 1,
            "description": "Sarah is the 3rd member of your 3-man band; this tiny campaign team operating out Mark’s dingy house. She’s a wizard with technology, one of the last in this era of stagnation, and obsessed with cryptography. If anyone can get to the bottom of this, it’s her.",
            "color_hex": "#bb00ff",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://i.imgur.com/iUzKyQe.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "You met her at the middle school lunch table, no one to talk to about her weird and nerdy interests. But you and Mark decided to take her in, and now she’s the third member of your 3-man band. You gave her refuge when everyone made fun of her and helped her stand up for herself.<br><br>Things have changed a lot since then. She’s learned how to keep her nerdiness down to a 7, and has developed more normal social skills. She’s a brilliant mind, and wizard with technology, one of the last great inventors in this era of eternal stagnation. If anyone can get to the bottom of this, it’s her.<br><br>Ever since you were young, she’s acted strangely around you. You can't put your finger on it.",
            "candidate_score": 1,
            "running_mate": true
        }
    },
	{
        "model": "campaign_trail.candidate",
        "pk": 308,
        "fields": {
            "first_name": "Edward",
            "last_name": "T. Roberts",
            "election": 21,
            "party": "Old World (Evangelical)",
            "state": "Alabama",
            "priority": 1,
            "description": "",
            "color_hex": "#bb00ff",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://i.imgur.com/qT786yU.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "Growing up poor in old south Alabama, from a young age, Roberts had watched as the world moved on and left him behind. As the businesses shuttered, the houses closed down, and the churches dwindled, one by one, his world is one is slow motion collapse. He barely scraped by into a high-class university, which ended up being his ticket out, as he left too.<br><br>A cry of anguish from rural America, long left behind by the machinations of the New World. He wants to return America to the days of old, a country of diners, nature, and God. And to revive the beautiful small-town America he remembers in the apple of his eye. Giving an acceptance speech to a crowd of Evangelicals, he has become the unofficial leader of the Christian Revivalist movement, hoping to ride a wave of revival all the way to the White House.",
            "candidate_score": 1,
            "running_mate": true
        }
    },
	{
        "model": "campaign_trail.candidate",
        "pk": 309,
        "fields": {
            "first_name": "Luca",
            "last_name": "Perez",
            "election": 21,
            "party": "Old World (Populist)",
            "state": "Texas",
            "priority": 1,
            "description": "",
            "color_hex": "#bb00ff",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://i.imgur.com/CgLMHbj.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "A billionaire startup founder born in New York, Perez’s philosophy has always been to go big or go home. If you’re not going to give it your all, then you shouldn’t try at all. Born the only child of Hispanic immigrants, he’s always felt immense pressure, holding up 2 generations behind him. It was a relief when he finally struck it big, but even though he did, the elites not accept him as one of them.<br><br>So, he lashed out, if they would not let him into their club, he would make his own. His righteous anger at the political establishment made him a media darling, a fact he hated. So he lashed out at them as well, decrying the establishment and the media alike. And the people began to see him as their own. Riding a wave of populism through the Old World primaries, he found his people. The elites who rejected him, he doesn’t need their approval anymore. But behind closed doors, those close to him say he still has a soft heart, and he never forgot about the family who gave him everything.",
            "candidate_score": 1,
            "running_mate": true
        }
    },
	{
        "model": "campaign_trail.candidate",
        "pk": 310,
        "fields": {
            "first_name": "John",
            "last_name": "King",
            "election": 21,
            "party": "Reform Independent (Populist)",
            "state": "Florida",
            "priority": 1,
            "description": "",
            "color_hex": "#bb00ff",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://i.imgur.com/Do1z5S6.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "He always made music because he wanted the world to be a better place. From the start, he just wanted to make people happy. In music he has found success, he has found fame. Over the years, King accrued many passions. Artist, writer, poet, musician, but in each one, his heart burnt out, over hundreds or thousands of years. It’s hard to live when you live forever.<br><br>He’s always had a taste for the world of politics, something he is deeply passionate about. Now he’s running as a send off his music career, a final thank-you for his loyal fans. His fans are standing behind him, and the road to forever stands in front of him. He’s ready to make the next big jump into the next big thing. In interviews, he often speaks about the struggles of living forever, and how his music was meant to help those who wanted to cope with it. Though he wasn’t Old World, he wanted to get into office so he could change things for the better.",
            "candidate_score": 1,
            "running_mate": true
        }
    },
	{
        "model": "campaign_trail.candidate",
        "pk": 311,
        "fields": {
            "first_name": "Tim",
            "last_name": "Jacobs",
            "election": 21,
            "party": "Reform Independent (Technocratic)",
            "state": "Illinois",
            "priority": 1,
            "description": "",
            "color_hex": "#bb00ff",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://i.imgur.com/pL2a0aE.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "Jacobs came to office on a very simple promise. If you elect me, I will get the job done. A thoroughly boring character, he has spent his eons working up through the levels of government, understanding every intricate detail. He came into the race not out of passion, but obligation. No one understood the machinery of governance better than he did. And he felt he was the only one who could manage it in a time of great turmoil.<br><br>Cultivating a support base of almost entirely technocrats and policy wonks, few can deny his policy isn’t “reasonable and well thought-through”. He’s worked bureaucratic desk jobs, from governor to desk worker, his entire life. In his private life, he is Jew-ish, emphasis on the ish. He lives a quiet, simple life with his wife, whom he loves.",
            "candidate_score": 1,
            "running_mate": true
        }
    },
	{
        "model": "campaign_trail.candidate",
        "pk": 312,
        "fields": {
            "first_name": "Emilia",
            "last_name": "Kelly",
            "election": 21,
            "party": "New World (Globalist)",
            "state": "California",
            "priority": 1,
            "description": "",
            "color_hex": "#bb00ff",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://i.imgur.com/Wqa2Kx1.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "Kelly was born to two wealthy Harvard graduate African-American parents, and has lived in that bubble ever since. Her parents are giants, Nobel-Prize winning researchers and professors. She went to Yale off their dime, and all her life, her parents have cast a shadow over her.<br><br>She’s spent her entire young adulthood fighting for what she cares about, trying to do everything she could to help them. But no matter what, she never seemed to be able to win over the working classes. So, she pivoted, going into the United Nations, trudging through war and medical triage to prove she could make a difference. She’s gone around the entire world to prove that she is not just a nepo baby. Deep down, she thinks she isn’t trying to convince the world, but trying to convince herself.",
            "candidate_score": 1,
            "running_mate": true
        }
    },
	{
        "model": "campaign_trail.candidate",
        "pk": 313,
        "fields": {
            "first_name": "Elizabeth",
            "last_name": "Haley",
            "election": 21,
            "party": "New World (Esoteric)",
            "state": "Massechusetts",
            "priority": 1,
            "description": "",
            "color_hex": "#bb00ff",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://i.imgur.com/elHoDdR.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "Haley doesn’t seem to have been born, as far as federal records are concerned. One day she kind of just… Appeared. She spoke fluent English, carried an American passport, and even a Social Security number, yet the federal government could not track her down. Eventually, they let her go, and allowed her to stay.<br><br>Haley herself has been vague about her origins, but whatever it was, it seems to have taken a toll on her sanity. She says she’s come to save a country in grave danger, warning about everything from aliens to UFOs, to alternate dimensions and parallel universes. She ran in the New World primaries, but it seems her notoriety catapulted her to the top. She runs a small sect of Christianity, a weird one, with all the oddities of her other beliefs.",
            "candidate_score": 1,
            "running_mate": true
        }
    },
];
		
e.running_mate_json = [
	{"model":"campaign_trail.running_mate","pk":2001,"fields":{"candidate":300,"running_mate":304}}];

e.credits = `<span style = "background: cyan; color: black; cursor: pointer;", onclick = "alert('All coding done by u/naimina_os.\\n\\nMuch thanks to u/RagyTheKindaHipster for coding help on this unsightly, bodged together project held together by hot glue and duct tape.\\n\\nThank you to Ronnie (u/thebig-boi), who helped out with writing.\\n\\nAnd finally, thank you to my wonderful playtesters, who believed in this project before it was done.\\n\\nThe Original 19: jonfromca, realtrey19, DalTheFox, nephrenkur (EmpireUnited), yaoboihf (HF), epicisman7770_72446, everynametaken, libertarianfellow (Frank Lowden), genevra (Genny), jocab. (Its never been more Joever), ncrranger2122 (Minute Man), mumkey_9814 (MUMKEY), munastronaut, liutenant_ (ordep), ashraf177 (pootmehoot), ronnierouser (Ronnie), spacenerd4 (bacheist), literallyparticracy, and wolfgang2337 (Wolfgang).')">several people. Click me for credits!</span>`;

e.global_parameter_json =[
	{
		"model":"campaign_trail.global_parameter",
		"pk":1,
		"fields":{"vote_variable":1.125,
		"max_swing":0.12,
		"start_point":0.1,
		"candidate_issue_weight":10,
		"running_mate_issue_weight":3,
		"issue_stance_1_max":-0.7,
		"issue_stance_2_max":-0.4,
		"issue_stance_3_max":-0.1,
		"issue_stance_4_max":0.1,
		"issue_stance_5_max":0.4,
		"issue_stance_6_max":0.7,
		"global_variance":0.01,
		"state_variance":0.005,
		"question_count":25,
		"default_map_color_hex":"#C9C9C9",
		"no_state_map_color_hex":"#999999"}
	}
];

campaignTrail_temp.temp_election_list = [
    {
        "id": 21,
        "year": 2020,
        "is_premium": 0,
        "display_year": "21028 CE"
    }
]

//#startcode

corrr = '<h2>THE CAMPAIGN TRAIL</h2><font id="wittyquote" size="4" color="white"><em>"Something is terribly wrong." - Nine</em></font>';

nct_stuff.themes[nct_stuff.selectedTheme].coloring_title = "#555555";
$("#game_window")[0].style.backgroundColor = "#222222";
$(".container")[0].style.backgroundColor = "#000000";
document.getElementById("header").src = "https://i.imgur.com/Nz05FuE.png";
document.body.background = "https://i.imgur.com/HF3PH63.png";
document.head.innerHTML += "<style>#results_container {color:#000000;} .inner_window_w_desc {background-color:#333333!important;}</style>";

document.getElementById("game_start").addEventListener("click", darkMode1);

document.head.innerHTML += `<style>
	.game_header {
		background: #555555;
	}
	#header {
		src: "https://i.imgur.com/Nz05FuE.png";
	}
	body {
		background: url("https://i.imgur.com/HF3PH63.png")
	}
	#game_window {
		background: #222222;
	}
	.inner_window_w_desc {
		background: #333333!important;
	}`;


function darkMode1() {
	document.getElementsByName("election_year")[0].style = "color:white";
	document.getElementById("credits").style = "color:white";
	document.getElementById("election_id_button").addEventListener("click", darkMode2);
}

function darkMode2() {
	document.getElementsByName("candidate")[0].style = "color:white";
	document.getElementById("candidate_id_back").addEventListener("click", darkMode1);
	document.getElementById("candidate_id_button").addEventListener("click", darkMode3);
}

function darkMode3() {
	document.getElementsByName("running mate")[0].style = "color:white";
	document.getElementById("running_mate_id_back").addEventListener("click", darkMode2);
	document.getElementById("running_mate_id_button").addEventListener("click", darkMode4);
}

function darkMode4() {
	document.getElementsByName("game_type_selection")[0].style = "color:white";
	document.getElementsByName("difficulty_level_selection")[0].style = "color:white";
	document.getElementById("opponent_selection_id_back").addEventListener("click", darkMode3);
}


// Initialise custom music

$("#music_player")[0].children[0].style.display="none"
$("#music_player")[0].children[1].style.display="none"

document.getElementById("modLoadReveal").style.display="none"
document.getElementById("modloaddiv").style.display="none"

musicBox = document.getElementById("music_player")
musicBox.style.display=""

var trackSel;
e = campaignTrail_temp
e.selectedSoundtrack = 0

toTime = (seconds) => {
  var date = new Date(null);
  date.setSeconds(seconds);
  return date.toISOString().substr(11, 8);
}

generateTime = () => {
    // Get the audio element
    var audio = document.getElementById("campaigntrailmusic");

    timeTracker = document.createElement("div");
    timeTracker.style = `
      text-align:left;
      border-style:solid;
      border-width:3px;
      height:150px;
      width:200px;
      background-color:#999999;
      float:right;
      padding: 10px;
    `
    $("#trackSelParent")[0].prepend(timeTracker);
    $("#trackSelParent")[0].prepend(document.createElement("br"));

    // Create a new element to display the current position of the audio
    var positionDisplay = document.createElement("gg");
    positionDisplay.id = "position-display";

    // Create a new slider element to change the time
    var timeSlider = document.createElement("input");
    timeSlider.type = "range";
    timeSlider.min = 0;
    timeSlider.max = 1;
    timeSlider.step = 0.001;
    timeSlider.value = 0;
    timeSlider.style.width = "200px";
    timeSlider.id = "time-slider";

    var pausePlay = document.createElement("button");
    pausePlay.id = "position-display";
    pausePlay.innerHTML = "<b>Pause</b>"
    pausePlay.style.width = "100%";


    pausePlay.addEventListener("click", event => {
      event.preventDefault();
      updatePositionDisplay();
      let audio = document.getElementById("campaigntrailmusic");
      if (audio.paused) {
        audio.play();
        event.target.innerHTML = "<b>Pause</b>";
        return;
      }
      audio.pause();
      event.target.innerHTML = "<b>Play</b>";
      return;
    })

    var volumeLabel = document.createElement("gg");
    volumeLabel.id = "volume-label";
    volumeLabel.innerHTML = "<br><b>Volume: </b>"

    var volumeSlider = document.createElement("input");
    volumeSlider.type = "range";
    volumeSlider.min = 0;
    volumeSlider.max = 1;
    volumeSlider.step = 0.001;
    volumeSlider.value = 0;
    volumeSlider.style.width = "200px";
    volumeSlider.id = "volume-slider";

    volumeSlider.value = audio.volume;

    timeTracker.appendChild(pausePlay);
    timeTracker.appendChild(document.createElement("br"));
    timeTracker.appendChild(document.createElement("br"));
    timeTracker.appendChild(positionDisplay);
    timeTracker.appendChild(timeSlider);
    timeTracker.appendChild(volumeLabel);
    timeTracker.appendChild(volumeSlider);

    updatePositionDisplay();

    //for (let i = 0; i < 10; i++)
    //timeTracker.append(document.createElement("br"));


    // Function to update the position display
    function updatePositionDisplay() {
      positionDisplay.innerHTML = "<b>Time:</b> " + toTime(audio.currentTime) + "<br>";
      timeSlider.value = audio.duration ? audio.currentTime / audio.duration : 0;
    }

    // Function to change the time of the audio
    function changeTime() {
      positionDisplay.innerHTML = "<b>Time:</b> " + toTime(audio.currentTime) + "<br>";
      audio.currentTime = timeSlider.value * audio.duration;
    }

    updateVolume = event => {
      audio.volume = event.target.value;
    }
    
    // Update the position display and slider every second
    setInterval(updatePositionDisplay, 1000);

    // Listen for changes to the time slider and change the time of the audio
    timeSlider.addEventListener("input", changeTime);
    volumeSlider.addEventListener("input", updateVolume)
}

function newMusicPlayer() {
  trackSel = document.createElement("div");
  trackSel.id = "trackSelParent"
  let z = `<br><br><br><br><br><br><br><br><br><br><div id='trackSel' style="text-align:left;border-style:solid;border-width:3px;overflow-y: scroll;overflow-x: hidden;height:200px; width:400px;background-color:#999999;float:right;">`
  z += `<b><select id='selectSoundtrack'><option value='`+soundtracks[e.selectedSoundtrack].name+`'>`+soundtracks[e.selectedSoundtrack].name+"</option>"
  for (i in soundtracks) {
    if (soundtracks[e.selectedSoundtrack] != soundtracks[i]) {
      z += `<option value='`+soundtracks[i].name+`'>`+soundtracks[i].name+`</option>`
    }
  }
  z += `</select></b><br><br>`
  // <label><input type="radio" name="option" value="option1">Option 1</label><br>
  for (i in soundtracks[e.selectedSoundtrack].tracklist) {
    let a = soundtracks[e.selectedSoundtrack].tracklist[i]
    let b = `<label><input class="trackSelector" type="radio" name="trackSelector" value="`+i+`">`+a.name+`</label><br>`
    z += b
  }
  z += "</div><br><br>"
  trackSel.innerHTML = z

  // select correct song

  musicBox.appendChild(trackSel);
  Array.from(document.getElementById("trackSel").children).filter(f=>{
    return f.tagName == "LABEL"
  }).map(f=>f.children[0])[0].checked = true

  // set soundtrack changer

  soundtrackSelector = document.getElementById("selectSoundtrack")
  soundtrackSelector.onchange = function() {
    for (i in soundtracks) {
      if (soundtracks[i].name == soundtrackSelector.value) {
        e.selectedSoundtrack = i
        break
      }
    }
    document.getElementById("trackSelParent").remove()
    newMusicPlayer()
  }

  var matches = document.querySelectorAll('.trackSelector');

  for (match in matches) {
    matches[match].onchange = function() {
      audio = $("#campaigntrailmusic")[0];
      audio.src = soundtracks[e.selectedSoundtrack].tracklist[this.value].url
      audio.currentTime = 0
    }
  }

  musicBox.children[2].loop = false
  musicBox.children[2].src = soundtracks[e.selectedSoundtrack].tracklist[0].url

  musicBox.children[2].onended = function() {
    console.log("next track")
    let selected = Number(document.querySelector('input[name="trackSelector"]:checked').value);
    let newSel = clamp(selected+1, soundtracks[e.selectedSoundtrack].tracklist.length-1, 0)
    let buttons = Array.from(document.getElementById("trackSel").children).filter(f=>{
      return f.tagName == "LABEL"
    }).map(f=>f.children[0])
    //let selectedIndex = buttons.map(f=>f.children[0]).map(f=>f.checked)
    buttons[newSel].click()
  }

  for (let counter = 0; counter < 7; counter++) {
    document.getElementById("trackSelParent").appendChild(document.createElement("br"))
  }
  
  generateTime();
}

clamp = function(a, max, min, overflow=true) {
  if (overflow) {
    return a > max ? min : a < min ? max : a;
  }
  return a > max ? max : a < min ? min : a;
}


// Track list

soundtracks = {
  0: {
    name: "Intro",
    tracklist: [
	  {
        "name": "Robot's Outro - PKK",
        "url": 'https://audio.jukehost.co.uk/AYUPLM4TmsXr7dTw7Ycwj3DRmjw6EdJA'
      },
	  {
        "name": "17776 - Sweet Victory",
        "url": 'https://audio.jukehost.co.uk/j8CBuQL9K4nOMtoqtRFE0vtcvewASqTY'
      },
    ],
  },
  1: {
    name: "Prologue: It's lonely out here",
    tracklist: [
      {
        "name": "UVB 76 NAIMINA",
        "url": 'https://audio.jukehost.co.uk/kCtcPCCaAH1CX3o8yZY47LneEyzvyxBU'
      },
	  {
        "name": "UVB 76 ERMINIA",
        "url": 'https://audio.jukehost.co.uk/kCtcPCCaAH1CX3o8yZY47LneEyzvyxBU'
      },
    ]
  },
  2: {
    name: "Chapter 1: Welcome to the New World",
    tracklist: [
      {
        "name": "01.01.1997 - Amour",
        "url": "https://audio.jukehost.co.uk/xkxETxLRBfNENiNtpx8w2M2yGGw7k6tx"
      },
	  {
        "name": "17776 - Heartfelt",
        "url": 'https://audio.jukehost.co.uk/Rrde5xVzJnsDU50I9hm30gz8jhD3cugO'
      },
	  {
        "name": "Ellipse - Oh Hiroshima",
        "url": "https://audio.jukehost.co.uk/kYMD9V6cHaBmxHwGgONQvdo4WeqGK4au"
      },
	  {
        "name": "Worth Everything Ever Wished For - End of the Ocean",
        "url": "https://audio.jukehost.co.uk/q6Pn70On9HRCyEomOXgD06xWyXzaDwyf"
      },
    ]
  },
  3: {
    name: "Chapter 2: Fracturing Utopia",
    tracklist: [
	  {
        "name": "Mortal Coil - God is an Astronaut",
        "url": "https://audio.jukehost.co.uk/slh8HSRDr4187nZwkWGnJSuSZUulQ3ru"
      },
	  {
        "name": "17776 - Lamentation",
        "url": 'https://audio.jukehost.co.uk/mA8ZI8dvhMxIm8HqAYIOyLmypMpRfLpX'
      },
      {
        "name": "Age of the 5th Sun - God is an Astronaut",
        "url": "https://audio.jukehost.co.uk/KJdDcKIzZ8DCnsL5qgihxcWsgleBcDxa"
      },
    ]
  },
}

// Set up new music player

newMusicPlayer()
